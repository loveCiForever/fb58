{"level":"error","message":"Error changing password: Illegal arguments: string, undefined","stack":"Error: Illegal arguments: string, undefined\n    at _async (D:\\Zenng\\git\\fb58\\server\\node_modules\\bcryptjs\\dist\\bcrypt.js:286:46)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\bcryptjs\\dist\\bcrypt.js:307:17\n    at new Promise (<anonymous>)\n    at bcrypt.compare (D:\\Zenng\\git\\fb58\\server\\node_modules\\bcryptjs\\dist\\bcrypt.js:306:20)\n    at changePassword (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\userController.js:85:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-15T19:38:43.567Z"}
{"_message":"User validation failed","errors":{"email":{"kind":"regexp","message":"Please enter a valid email","name":"ValidatorError","path":"email","properties":{"message":"Please enter a valid email","path":"email","regexp":{},"type":"regexp","value":"admin@nguyentrannhatan2812"},"value":"admin@nguyentrannhatan2812"},"password":{"kind":"minlength","message":"Password must be at least 6 characters long","name":"ValidatorError","path":"password","properties":{"message":"Password must be at least 6 characters long","minlength":6,"path":"password","type":"minlength","value":"admin"},"value":"admin"}},"level":"error","message":"Error creating admin account: User validation failed: email: Please enter a valid email, password: Password must be at least 6 characters long","stack":"ValidationError: User validation failed: email: Please enter a valid email, password: Password must be at least 6 characters long\n    at Document.invalidate (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-05-15T20:00:16.148Z"}
{"address":"::1","code":"ESOCKET","command":"CONN","errno":-4078,"level":"error","message":"Error sending booking confirmation email: connect ECONNREFUSED ::1:587","port":587,"stack":"Error: connect ECONNREFUSED ::1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1634:16)","syscall":"connect","timestamp":"2025-05-15T21:21:51.008Z"}
{"address":"::1","code":"ESOCKET","command":"CONN","errno":-4078,"level":"error","message":"Failed to send booking confirmation email: connect ECONNREFUSED ::1:587","port":587,"stack":"Error: connect ECONNREFUSED ::1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1634:16)","syscall":"connect","timestamp":"2025-05-15T21:21:51.009Z"}
{"address":"::1","code":"ESOCKET","command":"CONN","errno":-4078,"level":"error","message":"Error sending booking confirmation email: connect ECONNREFUSED ::1:587","port":587,"stack":"Error: connect ECONNREFUSED ::1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1634:16)","syscall":"connect","timestamp":"2025-05-15T21:25:15.047Z"}
{"address":"::1","code":"ESOCKET","command":"CONN","errno":-4078,"level":"error","message":"Failed to send booking confirmation email: connect ECONNREFUSED ::1:587","port":587,"stack":"Error: connect ECONNREFUSED ::1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1634:16)","syscall":"connect","timestamp":"2025-05-15T21:25:15.048Z"}
{"code":"EAUTH","command":"API","level":"error","message":"Error sending booking confirmation email: Missing credentials for \"PLAIN\"","stack":"Error: Missing credentials for \"PLAIN\"\n    at SMTPConnection._formatError (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:809:19)\n    at SMTPConnection.login (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:454:38)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-transport\\index.js:272:32\n    at SMTPConnection.<anonymous> (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:215:17)\n    at Object.onceWrapper (node:events:632:28)\n    at SMTPConnection.emit (node:events:518:28)\n    at SMTPConnection._actionEHLO (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:1371:14)\n    at SMTPConnection._processResponse (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:993:20)\n    at SMTPConnection._onData (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:774:14)\n    at SMTPConnection._onSocketData (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:195:44)","timestamp":"2025-05-15T21:26:30.040Z"}
{"bookingId":"68265c03237f9d85687afdf6","error":"Missing credentials for \"PLAIN\"","level":"error","message":"Failed to send booking confirmation email:","timestamp":"2025-05-15T21:26:30.041Z","userEmail":"zenng333@gmail.com","userId":"682657bd7adc22001a532962"}
{"code":"EAUTH","command":"API","level":"error","message":"Email configuration error: Missing credentials for \"PLAIN\"","stack":"Error: Missing credentials for \"PLAIN\"\n    at SMTPConnection._formatError (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:809:19)\n    at SMTPConnection.login (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:454:38)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-transport\\index.js:375:32\n    at SMTPConnection.<anonymous> (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:215:17)\n    at Object.onceWrapper (node:events:632:28)\n    at SMTPConnection.emit (node:events:518:28)\n    at SMTPConnection._actionEHLO (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:1371:14)\n    at SMTPConnection._processResponse (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:993:20)\n    at SMTPConnection._onData (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:774:14)\n    at SMTPConnection._onSocketData (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:195:44)","timestamp":"2025-05-15T21:27:17.240Z"}
{"code":"EAUTH","command":"API","level":"error","message":"Email configuration error: Missing credentials for \"PLAIN\"","stack":"Error: Missing credentials for \"PLAIN\"\n    at SMTPConnection._formatError (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:809:19)\n    at SMTPConnection.login (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:454:38)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-transport\\index.js:375:32\n    at SMTPConnection.<anonymous> (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:215:17)\n    at Object.onceWrapper (node:events:632:28)\n    at SMTPConnection.emit (node:events:518:28)\n    at SMTPConnection._actionEHLO (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:1371:14)\n    at SMTPConnection._processResponse (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:993:20)\n    at SMTPConnection._onData (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:774:14)\n    at SMTPConnection._onSocketData (D:\\Zenng\\git\\fb58\\server\\node_modules\\nodemailer\\lib\\smtp-connection\\index.js:195:44)","timestamp":"2025-05-15T21:27:47.915Z"}
{"_message":"Booking validation failed","errors":{"bookingStatus":{"kind":"enum","message":"`rejected` is not a valid enum value for path `bookingStatus`.","name":"ValidatorError","path":"bookingStatus","properties":{"enumValues":["pending","confirmed","cancelled"],"message":"`rejected` is not a valid enum value for path `bookingStatus`.","path":"bookingStatus","type":"enum","value":"rejected"},"value":"rejected"}},"level":"error","message":"Error rejecting booking: Booking validation failed: bookingStatus: `rejected` is not a valid enum value for path `bookingStatus`.","stack":"ValidationError: Booking validation failed: bookingStatus: `rejected` is not a valid enum value for path `bookingStatus`.\n    at Document.invalidate (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-05-15T21:42:58.547Z"}
{"_message":"Booking validation failed","errors":{"bookingStatus":{"kind":"enum","message":"`rejected` is not a valid enum value for path `bookingStatus`.","name":"ValidatorError","path":"bookingStatus","properties":{"enumValues":["pending","confirmed","cancelled"],"message":"`rejected` is not a valid enum value for path `bookingStatus`.","path":"bookingStatus","type":"enum","value":"rejected"},"value":"rejected"}},"level":"error","message":"Error rejecting booking: Booking validation failed: bookingStatus: `rejected` is not a valid enum value for path `bookingStatus`.","stack":"ValidationError: Booking validation failed: bookingStatus: `rejected` is not a valid enum value for path `bookingStatus`.\n    at Document.invalidate (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-05-15T21:43:22.905Z"}
{"_message":"Booking validation failed","errors":{"bookingStatus":{"kind":"enum","message":"`rejected` is not a valid enum value for path `bookingStatus`.","name":"ValidatorError","path":"bookingStatus","properties":{"enumValues":["pending","confirmed","cancelled"],"message":"`rejected` is not a valid enum value for path `bookingStatus`.","path":"bookingStatus","type":"enum","value":"rejected"},"value":"rejected"}},"level":"error","message":"Error rejecting booking: Booking validation failed: bookingStatus: `rejected` is not a valid enum value for path `bookingStatus`.","stack":"ValidationError: Booking validation failed: bookingStatus: `rejected` is not a valid enum value for path `bookingStatus`.\n    at Document.invalidate (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-05-15T21:43:46.054Z"}
{"level":"error","message":"Error getting field shifts: SHIFTS is not defined","stack":"ReferenceError: SHIFTS is not defined\n    at exports.getFieldShifts (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:328:36)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T04:50:53.722Z"}
{"level":"error","message":"Error getting field shifts: shifts.map is not a function","stack":"TypeError: shifts.map is not a function\n    at exports.getFieldShifts (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:331:43)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T04:52:06.700Z"}
{"_message":"Booking validation failed","errors":{"totalPrice":{"kind":"Number","message":"Cast to Number failed for value \"NaN\" (type number) at path \"totalPrice\"","name":"CastError","path":"totalPrice","reason":{"actual":false,"code":"ERR_ASSERTION","expected":true,"generatedMessage":true,"operator":"=="},"stringValue":"\"NaN\"","value":null,"valueType":"number"}},"level":"error","message":"Error creating booking: Booking validation failed: totalPrice: Cast to Number failed for value \"NaN\" (type number) at path \"totalPrice\"","stack":"ValidationError: Booking validation failed: totalPrice: Cast to Number failed for value \"NaN\" (type number) at path \"totalPrice\"\n    at Document.invalidate (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at model.$set (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:1480:12)\n    at model.$set (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:1132:16)\n    at model.Document (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:178:12)\n    at model.Model (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\model.js:128:12)\n    at new model (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\model.js:4813:15)\n    at exports.createBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:35:25)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T04:58:34.754Z"}
{"level":"error","message":"Error sending booking confirmation email: Cannot read properties of undefined (reading 'name')","stack":"TypeError: Cannot read properties of undefined (reading 'name')\n    at exports.sendBookingConfirmation (D:\\Zenng\\git\\fb58\\server\\src\\services\\emailService.js:39:38)\n    at exports.createBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:48:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T04:59:08.289Z"}
{"level":"error","message":"Error creating booking: Cannot read properties of undefined (reading 'name')","stack":"TypeError: Cannot read properties of undefined (reading 'name')\n    at exports.sendBookingConfirmation (D:\\Zenng\\git\\fb58\\server\\src\\services\\emailService.js:39:38)\n    at exports.createBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:48:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T04:59:08.289Z"}
{"level":"error","message":"Error sending booking confirmation email: Cannot read properties of undefined (reading 'email')","stack":"TypeError: Cannot read properties of undefined (reading 'email')\n    at exports.sendBookingConfirmation (D:\\Zenng\\git\\fb58\\server\\src\\services\\emailService.js:32:22)\n    at exports.confirmBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:171:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T05:01:03.662Z"}
{"level":"error","message":"Error sending confirmation email: Cannot read properties of undefined (reading 'email')","stack":"TypeError: Cannot read properties of undefined (reading 'email')\n    at exports.sendBookingConfirmation (D:\\Zenng\\git\\fb58\\server\\src\\services\\emailService.js:32:22)\n    at exports.confirmBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:171:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T05:01:03.663Z"}
{"_message":"Field validation failed","errors":{"capacity.players":{"kind":"required","message":"Number of players is required","name":"ValidatorError","path":"capacity.players","properties":{"message":"Number of players is required","path":"capacity.players","type":"required"}},"capacity.seats":{"kind":"required","message":"Number of seats is required","name":"ValidatorError","path":"capacity.seats","properties":{"message":"Number of seats is required","path":"capacity.seats","type":"required"}},"createdBy":{"kind":"required","message":"Path `createdBy` is required.","name":"ValidatorError","path":"createdBy","properties":{"message":"Path `createdBy` is required.","path":"createdBy","type":"required"}},"full_description":{"kind":"required","message":"Full description is required","name":"ValidatorError","path":"full_description","properties":{"message":"Full description is required","path":"full_description","type":"required"}},"short_description":{"kind":"required","message":"Short description is required","name":"ValidatorError","path":"short_description","properties":{"message":"Short description is required","path":"short_description","type":"required"}}},"level":"error","message":"Error creating sample fields: Field validation failed: createdBy: Path `createdBy` is required., capacity.seats: Number of seats is required, capacity.players: Number of players is required, full_description: Full description is required, short_description: Short description is required","stack":"ValidationError: Field validation failed: createdBy: Path `createdBy` is required., capacity.seats: Number of seats is required, capacity.players: Number of players is required, full_description: Full description is required, short_description: Short description is required\n    at Document.invalidate (D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3343:32)\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\document.js:3104:17\n    at D:\\Zenng\\git\\fb58\\server\\node_modules\\mongoose\\lib\\schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-05-16T05:15:34.431Z"}
{"level":"error","message":"Error sending booking confirmation email: Cannot read properties of undefined (reading 'email')","stack":"TypeError: Cannot read properties of undefined (reading 'email')\n    at exports.sendBookingConfirmation (D:\\Zenng\\git\\fb58\\server\\src\\services\\emailService.js:32:22)\n    at exports.confirmBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:171:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T05:25:58.925Z"}
{"level":"error","message":"Error sending confirmation email: Cannot read properties of undefined (reading 'email')","stack":"TypeError: Cannot read properties of undefined (reading 'email')\n    at exports.sendBookingConfirmation (D:\\Zenng\\git\\fb58\\server\\src\\services\\emailService.js:32:22)\n    at exports.confirmBooking (D:\\Zenng\\git\\fb58\\server\\src\\controllers\\bookingController.js:171:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-05-16T05:25:58.925Z"}
